<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AnimeStream ID | Nonton Anime Sub Indo & English Subtitle Gratis</title>
  <meta name="description" content="Nonton anime sub indo gratis dengan kualitas HD. Update anime terbaru setiap hari dengan subtitle Indonesia dan English lengkap di AnimeStream ID.">
  <meta name="keywords" content="nonton anime, anime sub indo, streaming anime gratis, anime terbaru, anime hd, anime 2025">
  <meta name="author" content="AnimeStream ID">
  <!-- Ensure indexability -->
  <meta name="robots" content="index, follow">
  <!-- Make sure your canonical URL is correct and uses HTTPS -->
  <link rel="canonical" href="https://animestream-id.com/">
  <!-- Add language alternates if you have multiple language versions -->
  <link rel="alternate" hreflang="id" href="https://animestream-id.com/">
  <link rel="alternate" hreflang="en" href="https://animestream-id.com/en/">
  <!-- Open Graph tags for social media sharing -->
  <meta property="og:title" content="AnimeStream ID | Nonton Anime Sub Indo Gratis">
  <meta property="og:description" content="Nonton anime subtitle Indonesia terlengkap dan terbaru dengan kualitas HD tanpa iklan yang mengganggu.">
  <meta property="og:url" content="https://animestream-id.com/">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://animestream-id.com/images/logo.jpg">
  <meta property="og:image:alt" content="AnimeStream ID Logo">
  <!-- Twitter Card tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="AnimeStream ID | Nonton Anime Sub Indo Gratis">
  <meta name="twitter:description" content="Nonton anime subtitle Indonesia terlengkap dan terbaru dengan kualitas HD.">
  <meta name="twitter:image" content="https://animestream-id.com/images/logo.jpg">
  <!-- Add favicon -->
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <!-- Preconnect to important third-party domains -->
  <link rel="preconnect" href="https://api.jikan.moe">
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="preconnect" href="https://cdnjs.cloudflare.com">
  <!-- Critical CSS inline for faster loading -->
  <style>
    :root {
      --primary: #FF9800;
      --secondary: #E91E63;
      --dark: #1A1A2E;
      --light: #f1f1f1;
    }
    
    body {
      background-color: var(--dark);
      color: var(--light);
      font-family: 'Roboto', sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 0;
    }
    
    .navbar {
      background-color: #111128 !important;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .hero-section {
      background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('/images/hero-background.jpg');
      background-size: cover;
      background-position: center;
      padding: 100px 0;
      margin-bottom: 40px;
      text-align: center;
    }
  </style>
  <!-- Non-critical CSS loaded asynchronously -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" media="print" onload="this.media='all'">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'">
  <noscript>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  </noscript>
  <!-- Main CSS - load the rest of your styles here -->
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <!-- Main header with proper semantic HTML -->
  <header>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="/">
          <img src="Logo.png" alt="AnimeStream ID Logo" width="30" height="30" class="d-inline-block align-top">
          AnimeStream
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="/" aria-current="page">
                <i class="fas fa-home" aria-hidden="true"></i> Home
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/anime-list">
                <i class="fas fa-list" aria-hidden="true"></i> Anime List
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/genres">
                <i class="fas fa-tags" aria-hidden="true"></i> Genres
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/about">
                <i class="fas fa-info-circle" aria-hidden="true"></i> About
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Hero Section with semantic structure -->
    <div class="hero-section">
      <div class="container">
        <h1 class="hero-title">Welcome to AnimeStream ID</h1>
        <p class="hero-text">Temukan dan streaming anime favoritmu dengan subtitle Indonesia. Update setiap hari dengan kualitas terbaik.</p>
        <!-- Search Bar - Accessible form -->
        <div class="search-container">
          <form action="/search" method="get" role="search">
            <div class="input-group">
              <input type="search" id="search" name="q" class="form-control" placeholder="Cari anime..." aria-label="Search for anime">
              <button type="submit" class="btn search-btn">
                <i class="fas fa-search" aria-hidden="true"></i> Search
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </header>

  <main id="main-content">
    <div class="container">
      <!-- Ad container with proper labeling -->
      <aside class="ad-container">
        <div class="text-center mb-2">
          <small class="text-muted">Advertisement</small>
        </div>
        <div id="top-ad"></div>
      </aside>

      <!-- Search Results Section - Initially hidden but with accessible content -->
      <section id="search-results" aria-labelledby="search-results-title" style="display: none;">
        <h2 id="search-results-title" class="section-title">Hasil Pencarian</h2>
        <div id="anime-list" class="row"></div>
        <div id="loading-search" class="loader" style="display: none;" aria-hidden="true"></div>
        <div id="no-results" class="alert alert-warning text-center" style="display: none;">
          Anime tidak ditemukan. Silakan coba kata kunci lain.
        </div>
      </section>

      <!-- Trending Section - Add static content for search engines -->
      <section id="trending" class="mb-5" aria-labelledby="trending-title">
        <h2 id="trending-title" class="section-title">Trending Minggu Ini</h2>
        <div id="trending-anime" class="row">
          <!-- Static initial content for SEO (will be replaced by JS) -->
          <noscript>
            <div class="col-12">
              <p>Untuk melihat anime trending, silakan aktifkan JavaScript di browser Anda.</p>
              <p>Kunjungi <a href="/trending">halaman trending</a> untuk daftar lengkap.</p>
            </div>
          </noscript>
        </div>
        <div id="loading-trending" class="loader" aria-hidden="true"></div>
      </section>

      <!-- New Releases Section -->
      <section id="new-releases" class="mb-5" aria-labelledby="new-releases-title">
        <h2 id="new-releases-title" class="section-title">Anime Terbaru</h2>
        <div id="new-anime" class="row">
          <!-- Static initial content for SEO (will be replaced by JS) -->
          <noscript>
            <div class="col-12">
              <p>Untuk melihat anime terbaru, silakan aktifkan JavaScript di browser Anda.</p>
              <p>Kunjungi <a href="/new-releases">halaman anime terbaru</a> untuk daftar lengkap.</p>
            </div>
          </noscript>
        </div>
        <div id="loading-new" class="loader" aria-hidden="true"></div>
      </section>

      <!-- Popular Section -->
      <section id="popular" class="mb-5" aria-labelledby="popular-title">
        <h2 id="popular-title" class="section-title">Anime Populer</h2>
        <div id="popular-anime" class="row">
          <!-- Static initial content for SEO (will be replaced by JS) -->
          <noscript>
            <div class="col-12">
              <p>Untuk melihat anime populer, silakan aktifkan JavaScript di browser Anda.</p>
              <p>Kunjungi <a href="/popular">halaman anime populer</a> untuk daftar lengkap.</p>
            </div>
          </noscript>
        </div>
        <div id="loading-popular" class="loader" aria-hidden="true"></div>
      </section>

      <!-- Second ad container -->
      <aside class="ad-container">
        <div class="text-center mb-2">
          <small class="text-muted">Advertisement</small>
        </div>
        <div id="middle-ad"></div>
      </aside>

      <!-- Genres Section -->
      <section id="genres" class="mb-5" aria-labelledby="genres-title">
        <h2 id="genres-title" class="section-title">Genres</h2>
        <div id="genre-list" class="row mb-4">
          <!-- Static genre links for SEO -->
          <noscript>
            <div class="col-12">
              <p>Untuk melihat genre anime, silakan aktifkan JavaScript di browser Anda.</p>
              <p>Kunjungi <a href="/genres">halaman genre</a> untuk daftar lengkap.</p>
            </div>
          </noscript>
        </div>
        <div id="genre-anime" class="row"></div>
        <div id="loading-genres" class="loader" aria-hidden="true"></div>
      </section>

      <!-- About Section with rich content -->
      <section id="about" class="mb-5" aria-labelledby="about-title">
        <h2 id="about-title" class="section-title">Tentang AnimeStream</h2>
        <div class="row">
          <div class="col-md-8">
            <p>AnimeStream ID adalah platform streaming anime premium yang menyediakan berbagai judul anime terbaru dan klasik dengan subtitle Indonesia dan English. Kami berkomitmen untuk memberikan pengalaman menonton terbaik dengan update berkala dan kualitas tayangan HD.</p>
            <p>Tim kami bekerja keras untuk mengumpulkan database anime terlengkap untuk memenuhi kebutuhan para penggemar anime di Indonesia. Data kami bersumber dari Jikan API untuk menjamin informasi yang akurat dan terkini.</p>
            <h3>Fitur Utama:</h3>
            <ul>
              <li>Ribuan judul anime dengan subtitle Indonesia</li>
              <li>Update anime terbaru setiap hari</li>
              <li>Kualitas HD dengan berbagai pilihan resolusi</li>
              <li>Fitur pencarian dan filter berdasarkan genre</li>
              <li>Informasi lengkap tentang setiap anime</li>
            </ul>
          </div>
          <div class="col-md-4">
            <div class="card bg-dark">
              <div class="card-body">
                <h3>Hubungi Kami</h3>
                <p>Punya pertanyaan atau saran? Hubungi tim kami:</p>
                <address>
                  <p><i class="fas fa-envelope" aria-hidden="true"></i> <a href="mailto:info@animestream-id.com" class="text-light">info@animestream-id.com</a></p>
                  <p><i class="fas fa-comment" aria-hidden="true"></i> Discord: AnimeStream Community</p>
                </address>
                <div class="social-links mt-3">
                  <a href="https://facebook.com/animestreamid" aria-label="Facebook" class="text-light me-3"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a>
                  <a href="https://twitter.com/animestreamid" aria-label="Twitter" class="text-light me-3"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
                  <a href="https://instagram.com/animestreamid" aria-label="Instagram" class="text-light me-3"><i class="fab fa-instagram fa-lg" aria-hidden="true"></i></a>
                  <a href="https://discord.gg/animestreamid" aria-label="Discord" class="text-light"><i class="fab fa-discord fa-lg" aria-hidden="true"></i></a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer with proper semantic structure -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-4">
          <h3><i class="fas fa-play-circle" aria-hidden="true"></i> AnimeStream ID</h3>
          <p>Platform streaming anime sub Indo terbaik dan terlengkap di Indonesia.</p>
        </div>
        <div class="col-md-4 mb-4">
          <h3>Navigasi Cepat</h3>
          <nav aria-label="Footer navigation">
            <ul class="list-unstyled">
              <li><a href="/" class="text-decoration-none text-light">Home</a></li>
              <li><a href="/anime-list" class="text-decoration-none text-light">Anime List</a></li>
              <li><a href="/genres" class="text-decoration-none text-light">Genres</a></li>
              <li><a href="/about" class="text-decoration-none text-light">About</a></li>
            </ul>
          </nav>
        </div>
        <div class="col-md-4">
          <h3>Disclaimer</h3>
          <p class="small">AnimeStream ID tidak menyimpan file anime di server kami. Semua konten disediakan oleh pihak ketiga yang tidak berafiliasi.</p>
        </div>
      </div>
      <hr class="bg-light">
      <div class="text-center">
        <nav aria-label="Legal links">
          <p class="footer-links">
            <a href="/terms" class="text-light">Terms of Service</a>
            <a href="/privacy" class="text-light">Privacy Policy</a>
            <a href="/dmca" class="text-light">DMCA</a>
            <a href="/contact" class="text-light">Contact</a>
          </p>
        </nav>
        <p>&copy; 2025 AnimeStream ID | Dibuat dengan <i class="fas fa-heart text-danger" aria-hidden="true"></i> untuk penggemar anime</p>
      </div>
    </div>
  </footer>

  <!-- Script for handling basic functionality without JS -->
  <noscript>
    <div class="container">
      <div class="alert alert-warning text-center my-4">
        <p>Untuk pengalaman terbaik, aktifkan JavaScript di browser Anda.</p>
        <p>Anda dapat mengakses konten statis kami melalui <a href="/sitemap">peta situs</a>.</p>
      </div>
    </div>
  </noscript>

  <!-- Defer non-critical JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>
  
  <!-- Main script with inline initial content rendering -->
  <script>
    // Initial content for search engines (executed immediately)
    document.addEventListener('DOMContentLoaded', function() {
      // Add skeleton content for better UX while loading
      if (document.getElementById('trending-anime')) {
        createSkeletonLoaders('trending-anime', 4);
      }
      if (document.getElementById('new-anime')) {
        createSkeletonLoaders('new-anime', 4);
      }
      if (document.getElementById('popular-anime')) {
        createSkeletonLoaders('popular-anime', 4);
      }
      
      // Start loading data
      loadInitialData();
    });
    
    // Function to create skeleton loaders
    function createSkeletonLoaders(containerId, count) {
      const container = document.getElementById(containerId);
      if (!container) return;
      
      let skeletons = '';
      for (let i = 0; i < count; i++) {
        skeletons += `<div class="col-6 col-md-3 mb-4"><div class="skeleton-card" aria-hidden="true"></div></div>`;
      }
      container.innerHTML = skeletons;
    }
    
    // Load initial data with timeout to avoid rate limiting
    function loadInitialData() {
      // Delay loading to prioritize page render
      setTimeout(() => fetchTrendingAnime(), 300);
      setTimeout(() => fetchNewAnime(), 600);
      setTimeout(() => fetchPopularAnime(), 900);
      setTimeout(() => fetchGenres(), 1200);
    }

    // Throttle function to limit API calls
    function throttle(func, limit) {
      let inThrottle;
      return function() {
        const args = arguments;
        const context = this;
        if (!inThrottle) {
          func.apply(context, args);
          inThrottle = true;
          setTimeout(() => inThrottle = false, limit);
        }
      };
    }

    // Format the anime card with proper semantic structure
    function formatAnimeCard(anime, section) {
      // Generate genres pills
      let genresHTML = '';
      if (anime.genres && anime.genres.length > 0) {
        anime.genres.slice(0, 3).forEach(genre => {
          genresHTML += `<span class="genre-pill">${genre.name}</span>`;
        });
      }
      
      // Format rating with stars
      const rating = anime.score ? anime.score : 'N/A';
      const ratingStars = anime.score ? generateStars(anime.score) : '';
      
      return `
        <div class="col-6 col-md-3 mb-4">
          <article class="anime-card h-100">
            <img src="${anime.images.jpg.large_image_url || anime.images.jpg.image_url}" 
                 class="card-img-top" 
                 alt="${anime.title}" 
                 width="225" height="335"
                 loading="lazy">
            <div class="card-body d-flex flex-column">
              <h3 class="card-title h5" title="${anime.title}">${anime.title}</h3>
              <div class="rating">
                ${ratingStars} <span>${rating}</span>
              </div>
              <div class="mb-2">
                ${genresHTML}
              </div>
              <div class="d-flex justify-content-between mt-auto">
                <a href="/anime/${anime.mal_id}" class="btn btn-detail btn-sm">
                  <i class="fas fa-info-circle" aria-hidden="true"></i> Detail
                </a>
                <a href="/watch/${anime.mal_id}" class="btn btn-watch btn-sm">
                  <i class="fas fa-play" aria-hidden="true"></i> Watch
                </a>
              </div>
            </div>
          </article>
        </div>
      `;
    }

    // Generate star rating
    function generateStars(score) {
      let starsHTML = '';
      const fullStars = Math.floor(score / 2);
      const halfStar = score % 2 >= 1 ? 1 : 0;
      const emptyStars = 5 - fullStars - halfStar;
      
      for (let i = 0; i < fullStars; i++) {
        starsHTML += '<i class="fas fa-star" aria-hidden="true"></i>';
      }
      if (halfStar) {
        starsHTML += '<i class="fas fa-star-half-alt" aria-hidden="true"></i>';
      }
      for (let i = 0; i < emptyStars; i++) {
        starsHTML += '<i class="far fa-star" aria-hidden="true"></i>';
      }
      
      return starsHTML;
    }

    // Search anime function with error handling and accessibility improvements
    async function searchAnime() {
      const query = document.getElementById('search').value.trim();
      if (!query) return;
      
      // Show loading and hide other sections
      document.getElementById('search-results').style.display = 'block';
      document.getElementById('loading-search').style.display = 'block';
      document.getElementById('no-results').style.display = 'none';
      document.getElementById('anime-list').innerHTML = '';
      
      try {
        const response = await fetch(`https://api.jikan.moe/v4/anime?q=${encodeURIComponent(query)}&sfw=true&limit=12`);
        if (!response.ok) throw new Error('API Error');
        const data = await response.json();
        
        if (!data || !data.data || data.data.length === 0) {
          document.getElementById('no-results').style.display = 'block';
          return;
        }
        
        let animesHTML = '';
        data.data.forEach(anime => {
          animesHTML += formatAnimeCard(anime, 'search');
        });
        
        document.getElementById('anime-list').innerHTML = animesHTML;
        
        // Update page URL for bookmarking and better SEO
        const searchUrl = new URL(window.location);
        searchUrl.searchParams.set('q', query);
        window.history.pushState({}, '', searchUrl);
        
      } catch (error) {
        console.error('Search error:', error);
        document.getElementById('anime-list').innerHTML = '<div class="col-12"><div class="alert alert-danger">Terjadi kesalahan saat mengambil data. Silakan coba lagi nanti.</div></div>';
      } finally {
        document.getElementById('loading-search').style.display = 'none';
      }
    }

    // Fetch trending anime with error handling
    async function fetchTrendingAnime() {
      try {
        const response = await fetch('https://api.jikan.moe/v4/top/anime?filter=airing&limit=8');
        if (!response.ok) throw new Error('API Error');
        const data = await response.json();
        
        let trendingHTML = '';
        data.data.forEach(anime => {
          trendingHTML += formatAnimeCard(anime, 'trending');
        });
        
        document.getElementById('trending-anime').innerHTML = trendingHTML;
      } catch (error) {
        console.error('Trending error:', error);
        document.getElementById('trending-anime').innerHTML = 
          '<div class="col-12"><div class="alert alert-danger">Terjadi kesalahan saat mengambil data trending anime.</div></div>';
      } finally {
        document.getElementById('loading-trending').style.display = 'none';
      }
    }

    // Fetch new anime releases with error handling
    async function fetchNewAnime() {
      try {
        const response = await fetch('https://api.jikan.moe/v4/seasons/now?limit=8');
        if (!response.ok) throw new Error('API Error');
        const data = await response.json();
        
        let newHTML = '';
        data.data.forEach(anime => {
          newHTML += formatAnimeCard(anime, 'new');
        });
        
        document.getElementById('new-anime').innerHTML = newHTML;
      } catch (error) {
        console.error('New releases error:', error);
        document.getElementById('new-anime').innerHTML = 
          '<div class="col-12"><div class="alert alert-danger">Terjadi kesalahan saat mengambil data anime terbaru.</div></div>';
      } finally {
        document.getElementById('loading-new').style.display = 'none';
      }
    }

    // Fetch popular anime with error handling
    async function fetchPopularAnime() {
      try {
        const response = await fetch('https://api.jikan.moe/v4/top/anime?filter=bypopularity&limit=8');
        if (!response.ok) throw new Error('API Error');
        const data = await response.json();
        
        let popularHTML = '';
        data.data.forEach(anime => {
          popularHTML += formatAnimeCard(anime, 'popular');
        });
        
        document.getElementById('popular-anime').innerHTML = popularHTML;
      } catch (error) {
        console.error('Popular error:', error);
        document.getElementById('popular-anime').innerHTML = 
          '<div class="col-12"><div class="alert alert-danger">Terjadi kesalahan saat mengambil data anime populer.</div></div>';
      } finally {
        document.getElementById('loading-popular').style.display = 'none';
      }
    }

    // Fetch genres with error handling
    async function fetchGenres() {
      try {
        const response = await fetch('https://api.jikan.moe/v4/genres/anime');
        if (!response.ok) throw new Error('API Error');
        const data = await response.json();
        
        let genresHTML = '';
        data.data.slice(0, 12).forEach(genre => {
          genresHTML += `
            <div class="col-6 col-md-2 mb-3">
              <button class="btn btn-outline-light w-100" onclick="fetchAnimeByGenre(${genre.mal_id}, '${genre.name}')">
                ${genre.name}
              </button>
            </div>
          `;
        });
        
        document.getElementById('genre-list').innerHTML = genresHTML;
      } catch (error) {
        console.error('Genres error:', error);
        document.getElementById('genre-list').innerHTML = 
          '<div class="col-12"><div class="alert alert-danger">Terjadi kesalahan saat mengambil data genre.</div></div>';
      } finally {
        document.getElementById('loading-genres').style.display = 'none';
      }
    }

    // Fetch anime by genre with improved URL handling for better SEO
    async function fetchAnimeByGenre(genreId, genreName) {
      try {
        document.getElementById('loading-genres').style.display = 'block';
        document.getElementById('genre-anime').innerHTML = '';
        document.getElementById('genres').scrollIntoView({ behavior: 'smooth' });
        
        // Update URL for better SEO and bookmarking
        const genreUrl = new URL(window.location);
        genreUrl.searchParams.set('genre', genreId);
        genreUrl.searchParams.set('genre_name', genreName);
        window.history.pushState({}, '', genreUrl);
        
        const response = await fetch(`https://api.jikan.moe/v4/anime?genres=${genreId}&limit=8`);
        if (!response.ok) throw new Error('API Error');
        const data = await response.json();
        
        // Add genre title with proper semantic HTML
        const genreTitleHTML = `<div class="col-12 mb-3"><h3>Anime ${genreName}</h3></div>`;
        
        let animeHTML = genreTitleHTML;
        data.data.forEach(anime => {
          animeHTML += formatAnimeCard(anime, 'genre');
        });
        
        document.getElementById('genre-anime').innerHTML = animeHTML;
      } catch (error) {
        console.error('Genre anime error:', error);
        document.getElementById('genre-anime').innerHTML = 
          '<div class="col-12"><div class="alert alert-danger">Terjadi kesalahan saat mengambil data anime untuk genre ini.</div></div>';
      } finally {
        document.getElementById('loading-genres').style.display = 'none';
      }
    }

   // Check for URL parameters on page load to support direct links
   function checkUrlParams() {
      const urlParams = new URLSearchParams(window.location.search);
      const query = urlParams.get('q');
      const genreId = urlParams.get('genre');
      const genreName = urlParams.get('genre_name');
      
      if (query) {
        document.getElementById('search').value = query;
        searchAnime();
      }
      
      if (genreId && genreName) {
        setTimeout(() => {
          fetchAnimeByGenre(genreId, genreName);
        }, 1500); // Delay to ensure genres are loaded
      }
    }

    // Add event listener for search
    document.querySelector('form[role="search"]').addEventListener('submit', function(e) {
      e.preventDefault();
      searchAnime();
    });

    // Check URL parameters after page loads
    window.addEventListener('DOMContentLoaded', () => {
      // Check for URL parameters
      checkUrlParams();
    });
  </script>

  <!-- Structured Data for SEO - Enhanced for better search visibility -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "AnimeStream ID",
    "url": "https://animestream-id.com/",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://animestream-id.com/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    },
    "description": "Nonton anime subtitle Indonesia terlengkap dan terbaru dengan kualitas HD tanpa iklan yang mengganggu."
  }
  </script>
  
  <!-- Organization schema for better branding in search results -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "AnimeStream ID",
    "url": "https://animestream-id.com/",
    "logo": "https://animestream-id.com/images/logo.png",
    "sameAs": [
      "https://facebook.com/animestreamid",
      "https://twitter.com/animestreamid",
      "https://instagram.com/animestreamid"
    ]
  }
  </script>
  
  <!-- BreadcrumbList schema for better navigation indexing -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://animestream-id.com/"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Anime List",
        "item": "https://animestream-id.com/anime-list"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Genres",
        "item": "https://animestream-id.com/genres"
      }
    ]
  }
  </script>

  <!-- Preload key resources -->
  <link rel="preload" href="/images/logo.png" as="image">
  <link rel="preload" href="/images/hero-background.jpg" as="image">
</body>
</html>